{{ define "main" }}

{{- /* Look up this project in data */}}
{{ $slug := .File.ContentBaseName }}
{{ $project := dict }}
{{ range .Site.Data.portfolio.projects }}
  {{ if eq .slug $slug }}
    {{ $project = . }}
  {{ end }}
{{ end }}

<section class="case-study-hero">
  <div class="container">
    <div>
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span class="breadcrumb-sep" aria-hidden="true">/</span>
        <a href="/portfolio/">Portfolio</a>
        <span class="breadcrumb-sep" aria-hidden="true">/</span>
        <span aria-current="page">{{ .Title }}</span>
      </nav>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-3xl);align-items:center;">
      <div>
        {{ with $project.logo }}
        <img
          src="{{ . }}"
          alt="{{ $project.name }} logo"
          width="120"
          height="60"
          loading="eager"
          style="max-height:60px;width:auto;object-fit:contain;margin-bottom:var(--space-xl);filter:brightness(0) invert(1);opacity:0.9;"
        >
        {{ end }}
        <h1 style="color:white;">{{ .Title }}</h1>
        <p style="color:rgba(255,255,255,0.8);font-size:1.1rem;margin-top:var(--space-md);">{{ .Description }}</p>
        <dl class="case-study-meta">
          {{ with $project.client }}
          <div class="case-study-meta-item">
            <dt>Client</dt>
            <dd>{{ . }}</dd>
          </div>
          {{ end }}
          {{ with $project.date }}
          <div class="case-study-meta-item">
            <dt>Date</dt>
            <dd>{{ . }}</dd>
          </div>
          {{ end }}
          {{ with $project.category }}
          <div class="case-study-meta-item">
            <dt>Industry</dt>
            <dd>{{ . }}</dd>
          </div>
          {{ end }}
          {{ with $project.location }}
          <div class="case-study-meta-item">
            <dt>Location</dt>
            <dd>{{ . }}</dd>
          </div>
          {{ end }}
        </dl>
      </div>
      {{ with $project.splash }}
      <div class="case-study-splash">
        <img
          src="{{ . }}"
          alt="{{ $project.name }} website screenshot"
          width="600"
          height="450"
          loading="eager"
          style="width:100%;height:auto;"
        >
      </div>
      {{ end }}
    </div>
  </div>
</section>

<section class="section">
  <div class="container container--narrow">
    <div class="post-content">
      {{ .Content }}
    </div>

    {{- /* Client testimonial from front matter */}}
    {{ with .Params.testimonial }}
    <div class="client-quote" style="margin-top:var(--space-3xl);">
      <blockquote>{{ .quote }}</blockquote>
      <div class="client-quote-author">
        {{ with $project.clientPhoto }}
        <img src="{{ . }}" alt="{{ $.Params.testimonial.author }}" width="48" height="48" loading="lazy">
        {{ end }}
        <div class="client-quote-author-info">
          <strong>{{ .author }}</strong>
          <span>{{ .role }}</span>
        </div>
      </div>
    </div>
    {{ end }}

  </div>
</section>

{{- /* Navigation between case studies */}}
<nav class="section section-alt" aria-label="Case study navigation">
  <div class="container" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--space-md);">
    {{ with .PrevInSection }}
    <a href="{{ .RelPermalink }}" class="btn btn-outline btn--sm">&larr; {{ .Title }}</a>
    {{ else }}<span></span>{{ end }}
    <a href="/portfolio/" class="btn btn-outline btn--sm">All Case Studies</a>
    {{ with .NextInSection }}
    <a href="{{ .RelPermalink }}" class="btn btn-outline btn--sm">{{ .Title }} &rarr;</a>
    {{ else }}<span></span>{{ end }}
  </div>
</nav>

<section class="cta-section">
  <div class="container">
    <h2>Ready to start your project?</h2>
    <p>Let's build something great together.</p>
    <a href="/contact-us/" class="btn" style="background:white;color:var(--color-primary);">Get in touch</a>
  </div>
</section>

{{ end }}
